<!DOCTYPE html>
<html lang="th">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ศูนย์การเรียนรู้เรื่องเซต</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.youtube.com/iframe_api"></script>
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Mitr:wght@200;300;400;500;600;700&display=swap"
        rel="stylesheet">
    <style>
        body {
            font-family: 'Mitr', sans-serif;
            background-color: #f8fafc;
            /* slate-50 */
        }

        /* --- Animations --- */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes modal-scale-in {
            from {
                opacity: 0;
                transform: scale(0.95);
            }

            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        @keyframes blob-move-1 {

            0%,
            100% {
                transform: translate(0, 0) scale(1);
            }

            25% {
                transform: translate(40px, -60px) scale(1.1);
            }

            50% {
                transform: translate(-30px, 30px) scale(0.9);
            }

            75% {
                transform: translate(20px, 50px) scale(1.2);
            }
        }

        @keyframes blob-move-2 {

            0%,
            100% {
                transform: translate(0, 0) scale(1);
            }

            25% {
                transform: translate(-50px, 30px) scale(1.2);
            }

            50% {
                transform: translate(40px, -40px) scale(0.8);
            }

            75% {
                transform: translate(-20px, -60px) scale(1.1);
            }
        }

        @keyframes blob-move-3 {

            0%,
            100% {
                transform: translate(0, 0) scale(1);
            }

            25% {
                transform: translate(30px, 50px) scale(1.1);
            }

            50% {
                transform: translate(-40px, -20px) scale(0.9);
            }

            75% {
                transform: translate(50px, -30px) scale(1.2);
            }
        }
        
        @keyframes countdown-zoom {
            0% { transform: scale(0.5); opacity: 0; }
            50% { transform: scale(1.2); opacity: 1; }
            100% { transform: scale(1); opacity: 1; }
        }

        .countdown-number {
            animation: countdown-zoom 1s ease-in-out;
        }

        /* Page transition animations */
        .section-enter-active {
            animation: slide-in-from-top 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
        }
        .section-leave-active {
            animation: slide-out-to-top 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
        }

        @keyframes slide-in-from-top {
            from {
                transform: translateY(-20px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
        @keyframes slide-out-to-top {
             from {
                transform: translateY(0);
                opacity: 1;
            }
            to {
                transform: translateY(20px);
                opacity: 0;
            }
        }

        .animated-blob {
            filter: blur(80px);
            transition: all 0.3s ease;
        }

        /* Typing indicator animation */
        .typing-indicator span {
            height: 8px;
            width: 8px;
            float: left;
            margin: 0 2px;
            background-color: #9E9EA1;
            display: block;
            border-radius: 50%;
            opacity: 0.4;
            animation: typing 1s infinite;
        }

        .typing-indicator span:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-indicator span:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes typing {

            0%,
            100% {
                opacity: 0.4;
                transform: scale(0.9);
            }

            50% {
                opacity: 1;
                transform: scale(1);
            }
        }

        /* Custom scrollbar for chat */
        .custom-scrollbar::-webkit-scrollbar {
            width: 6px;
        }

        .custom-scrollbar::-webkit-scrollbar-track {
            background: transparent;
        }

        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #d1d5db;
            border-radius: 10px;
        }

        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #9ca3af;
        }

        .flip-card-inner {
            transition: transform 0.6s;
            transform-style: preserve-3d;
        }

        .is-flipped {
            transform: rotateY(180deg);
        }

        .flip-card-front,
        .flip-card-back {
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
        }

        .flip-card-back {
            transform: rotateY(180deg);
        }

        /* Nav active state */
        .nav-link.active {
            border-bottom-color: #4f46e5;
            /* indigo-600 */
            color: #1e293b;
            /* slate-800 */
        }
        
        /* --- Aurora Button Effect --- */
        @keyframes aurora-shimmer {
            0% { transform: translate(-50%, -50%) rotate(0deg); }
            100% { transform: translate(-50%, -50%) rotate(360deg); }
        }

        .aurora-button {
            position: relative;
            overflow: hidden;
            z-index: 1;
            background-color: rgba(107, 33, 168, 0.5); /* fuchsia-800/50 */
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            transition: all 0.3s ease;
        }

        .aurora-button::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 150%;
            padding-bottom: 150%;
            background: conic-gradient(
                from 180deg at 50% 50%,
                rgba(236, 72, 153, 0.7) 0%, /* Pink */
                rgba(59, 130, 246, 0.7) 70%, /* Blue */
                rgba(236, 72, 153, 0.7) 100%
            );
            z-index: -1;
            transform: translate(-50%, -50%);
            opacity: 0;
            transition: opacity 0.5s ease-out;
            animation: aurora-shimmer 5s linear infinite;
        }

        .aurora-button:hover::before {
            opacity: 1;
        }
        .avatar-selection img {
            cursor: pointer;
            border: 4px solid transparent;
            transition: border-color 0.2s ease-in-out;
        }
        .avatar-selection img.selected {
            border-color: #4f46e5; /* indigo-600 */
        }
    </style>
</head>

<body class="antialiased text-slate-700">

    <!-- =========== Login Section =========== -->
    <section id="login-section" class="relative min-h-screen w-full flex items-center justify-center overflow-hidden transition-opacity duration-500">
        <!-- Animated Blobs -->
        <div class="absolute top-0 left-0 w-full h-full z-0">
            <div class="absolute top-1/4 left-1/4 w-72 h-72 bg-purple-300 rounded-full animated-blob opacity-70" style="animation: blob-move-1 15s infinite ease;"></div>
            <div class="absolute top-1/2 right-1/4 w-80 h-80 bg-blue-300 rounded-full animated-blob opacity-60" style="animation: blob-move-2 18s infinite ease-in-out;"></div>
            <div class="absolute bottom-1/4 left-1/3 w-60 h-60 bg-indigo-300 rounded-full animated-blob opacity-50" style="animation: blob-move-3 12s infinite linear;"></div>
        </div>

        <!-- Auth Container -->
        <div id="auth-container" class="relative z-10 w-full max-w-md p-8 space-y-8 bg-white/80 backdrop-blur-xl rounded-2xl shadow-2xl m-4">
            <!-- Login View -->
            <div id="login-view">
                <div class="text-center">
                    <h2 class="text-4xl font-bold text-slate-800">ยินดีต้อนรับ</h2>
                    <p class="mt-2 text-slate-600">เข้าสู่ระบบเพื่อใช้งาน</p>
                </div>
                <form id="login-form" class="mt-8 space-y-6">
                    <div id="login-error" class="hidden p-3 bg-red-100 text-red-700 rounded-lg text-sm"></div>
                    <div class="rounded-md shadow-sm -space-y-px">
                        <div>
                            <label for="login-email" class="sr-only">อีเมล</label>
                            <input id="login-email" name="email" type="email" autocomplete="email" required class="appearance-none rounded-none relative block w-full px-3 py-3 border border-slate-300 placeholder-slate-500 text-slate-900 rounded-t-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm" placeholder="อีเมล">
                        </div>
                        <div>
                            <label for="login-password" class="sr-only">รหัสผ่าน</label>
                            <input id="login-password" name="password" type="password" autocomplete="current-password" required class="appearance-none rounded-none relative block w-full px-3 py-3 border border-slate-300 placeholder-slate-500 text-slate-900 rounded-b-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm" placeholder="รหัสผ่าน">
                        </div>
                    </div>
                    <div>
                        <button type="submit" class="group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-lg text-white bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                            เข้าสู่ระบบ
                        </button>
                    </div>
                </form>
                <p class="mt-4 text-center text-sm text-slate-600">
                    ยังไม่มีบัญชี? <a href="#" id="show-signup" class="font-medium text-indigo-600 hover:text-indigo-500">สมัครสมาชิก</a>
                </p>
            </div>

            <!-- Signup View -->
            <div id="signup-view" class="hidden">
                 <div class="text-center">
                    <h2 class="text-4xl font-bold text-slate-800">สร้างบัญชีใหม่</h2>
                    <p class="mt-2 text-slate-600">เริ่มต้นการเรียนรู้ได้เลย!</p>
                </div>
                <form id="signup-form" class="mt-8 space-y-6">
                    <div id="signup-error" class="hidden p-3 bg-red-100 text-red-700 rounded-lg text-sm"></div>
                    <div class="rounded-md shadow-sm">
                         <div>
                            <label for="signup-username" class="sr-only">ชื่อผู้ใช้</label>
                            <input id="signup-username" name="username" type="text" required class="appearance-none rounded-none relative block w-full px-3 py-3 border border-slate-300 placeholder-slate-500 text-slate-900 rounded-t-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm" placeholder="ชื่อผู้ใช้">
                        </div>
                        <div class="-mt-px">
                            <label for="signup-email" class="sr-only">อีเมล</label>
                            <input id="signup-email" name="email" type="email" autocomplete="email" required class="appearance-none rounded-none relative block w-full px-3 py-3 border border-slate-300 placeholder-slate-500 text-slate-900 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm" placeholder="อีเมล">
                        </div>
                        <div class="-mt-px">
                            <label for="signup-password" class="sr-only">รหัสผ่าน</label>
                            <input id="signup-password" name="password" type="password" autocomplete="new-password" required class="appearance-none rounded-none relative block w-full px-3 py-3 border border-slate-300 placeholder-slate-500 text-slate-900 rounded-b-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm" placeholder="รหัสผ่าน">
                        </div>
                    </div>
                    <div>
                        <button type="submit" class="group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-lg text-white bg-gradient-to-r from-green-500 to-teal-500 hover:from-green-600 hover:to-teal-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500">
                            สมัครสมาชิก
                        </button>
                    </div>
                </form>
                 <p class="mt-4 text-center text-sm text-slate-600">
                    มีบัญชีอยู่แล้ว? <a href="#" id="show-login" class="font-medium text-indigo-600 hover:text-indigo-500">เข้าสู่ระบบ</a>
                </p>
            </div>
        </div>
    </section>

    <!-- =========== Main App Section =========== -->
    <main id="main-app" class="hidden opacity-0 transition-opacity duration-500 relative min-h-screen flex flex-col" style="animation: fadeIn 0.7s ease-out forwards;">
        <!-- Animated Blobs Background -->
        <div class="fixed top-0 left-0 w-full h-full z-[-1]">
            <div class="absolute -top-20 -left-20 w-80 h-80 bg-purple-300 rounded-full animated-blob opacity-30" style="animation: blob-move-1 15s infinite ease;"></div>
            <div class="absolute top-1/2 right-1/4 w-96 h-96 bg-blue-300 rounded-full animated-blob opacity-20" style="animation: blob-move-2 18s infinite ease-in-out;"></div>
            <div class="absolute bottom-0 -right-20 w-72 h-72 bg-indigo-300 rounded-full animated-blob opacity-30" style="animation: blob-move-3 12s infinite linear;"></div>
        </div>

        <!-- Header & Navigation -->
        <header class="bg-white/70 backdrop-blur-xl sticky top-0 z-40 shadow-sm border-b border-white/30">
            <div class="mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex justify-between items-center h-16">
                    <div class="flex-shrink-0">
                        <h1 class="text-2xl font-bold text-indigo-600">Set Theory Hub</h1>
                    </div>

                    <!-- Right side of navbar for desktop -->
                    <div class="hidden md:flex items-center">
                        <nav class="flex space-x-8">
                            <a href="#study-zone" class="nav-link text-slate-500 hover:text-slate-800 px-3 py-2 text-md font-medium border-b-2 border-transparent transition-all duration-300 active">โซนเรียนรู้</a>
                            <a href="#recap-arcade" class="nav-link text-slate-500 hover:text-slate-800 px-3 py-2 text-md font-medium border-b-2 border-transparent transition-all duration-300">อาเขตทบทวน</a>
                            <a href="#collab-hub" class="nav-link text-slate-500 hover:text-slate-800 px-3 py-2 text-md font-medium border-b-2 border-transparent transition-all duration-300">ศูนย์รวมความร่วมมือ</a>
                            <a href="#friends-challenge" class="nav-link text-slate-500 hover:text-slate-800 px-3 py-2 text-md font-medium border-b-2 border-transparent transition-all duration-300">ท้าทายเพื่อน</a>
                        </nav>

                        <!-- Profile Dropdown -->
                        <div class="relative ml-6" id="profile-menu">
                            <button id="profile-menu-button" type="button" class="flex items-center space-x-2 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 rounded-full">
                                <span id="user-name-desktop" class="text-sm font-medium text-slate-700 hidden lg:block"></span>
                                <img id="profile-img-desktop" class="h-9 w-9 rounded-full border-2 border-white shadow-sm object-cover" src="" alt="User Profile">
                            </button>
                            <div id="profile-menu-dropdown" class="hidden absolute right-0 mt-2 w-56 origin-top-right bg-white/80 backdrop-blur-lg rounded-md shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none py-1 border border-white/30" style="animation: fadeIn 0.15s ease-out;">
                                <div class="px-4 py-2">
                                    <p id="user-name-dropdown" class="text-sm font-semibold text-slate-800"></p>
                                    <p id="user-email-dropdown" class="text-sm text-slate-500 truncate"></p>
                                </div>
                                <div class="border-t border-slate-200/50 my-1"></div>
                                <a href="#profile-page" class="nav-link block px-4 py-2 text-sm text-slate-700 hover:bg-white/50 transition-colors">โปรไฟล์</a>
                                <a href="#settings-page" class="nav-link block px-4 py-2 text-sm text-slate-700 hover:bg-white/50 transition-colors">การตั้งค่า</a>
                                <div class="border-t border-slate-200/50 my-1"></div>
                                <a href="#" id="logout-btn" class="block px-4 py-2 text-sm text-slate-700 hover:bg-white/50 transition-colors">ออกจากระบบ</a>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Mobile menu button -->
                    <div class="md:hidden">
                        <button id="mobile-menu-button" class="inline-flex items-center justify-center p-2 rounded-lg text-indigo-600 bg-indigo-100 hover:bg-indigo-200 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-indigo-500 transition-colors duration-300">
                            <span class="sr-only">Open main menu</span>
                            <svg class="block h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                            </svg>
                        </button>
                    </div>
                </div>
            </div>
             <!-- Mobile menu, show/hide based on menu state. -->
            <div class="md:hidden hidden" id="mobile-menu">
                <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3 border-b border-slate-200">
                    <a href="#study-zone" class="nav-link text-slate-600 hover:bg-white/50 block px-3 py-2 rounded-md text-base font-medium active">โซนเรียนรู้</a>
                    <a href="#recap-arcade" class="nav-link text-slate-600 hover:bg-white/50 block px-3 py-2 rounded-md text-base font-medium">อาเขตทบทวน</a>
                    <a href="#collab-hub" class="nav-link text-slate-600 hover:bg-white/50 block px-3 py-2 rounded-md text-base font-medium">ศูนย์รวมความร่วมมือ</a>
                    <a href="#friends-challenge" class="nav-link text-slate-600 hover:bg-white/50 block px-3 py-2 rounded-md text-base font-medium">ท้าทายเพื่อน</a>
                </div>
                <div class="pt-4 pb-3">
                    <div class="flex items-center px-5">
                        <div class="flex-shrink-0">
                            <img id="profile-img-mobile" class="h-10 w-10 rounded-full object-cover" src="" alt="User Profile">
                        </div>
                        <div class="ml-3">
                            <div id="user-name-mobile" class="text-base font-medium text-slate-800"></div>
                            <div id="user-email-mobile" class="text-sm font-medium text-slate-500"></div>
                        </div>
                    </div>
                    <div class="mt-3 px-2 space-y-1">
                        <a href="#profile-page" class="nav-link block rounded-md px-3 py-2 text-base font-medium text-slate-600 hover:bg-white/50">โปรไฟล์</a>
                        <a href="#settings-page" class="nav-link block rounded-md px-3 py-2 text-base font-medium text-slate-600 hover:bg-white/50">การตั้งค่า</a>
                        <a href="#" id="mobile-logout-btn" class="block rounded-md px-3 py-2 text-base font-medium text-slate-600 hover:bg-white/50">ออกจากระบบ</a>
                    </div>
                </div>
            </div>
        </header>

        <!-- Content Sections -->
        <div class="flex-grow mx-auto py-8 px-4 sm:px-6 lg:px-8 w-full">
            <section id="study-zone" class="app-section">
                <h2 class="text-3xl font-bold text-slate-800 mb-6">โซนเรียนรู้: พื้นฐานเรื่องเซต</h2>
                <div class="bg-white/70 backdrop-blur-xl p-6 rounded-xl shadow-lg border border-white/30">
                    <div class="flex flex-col lg:flex-row gap-6">

                        <!-- Left Column: Video -->
                        <div class="lg:w-[60%] w-full relative">
                            <div id="player" class="aspect-video rounded-lg overflow-hidden bg-black shadow-lg">
                                <!-- YouTube Player will be inserted here by JS -->
                            </div>
                             <canvas id="video-overlay" class="hidden absolute top-0 left-0 w-full h-full pointer-events-none z-10"></canvas>
                        </div>

                        <!-- Right Column: AI Chat -->
                        <div class="lg:w-[40%] w-full flex flex-col">
                            <div class="flex flex-col h-full border border-white/30 rounded-lg bg-white/50 backdrop-blur-sm">
                                <div class="p-4 border-b border-white/30">
                                    <h3 class="font-semibold text-slate-800">ผู้ช่วย AI 'น้องขอม'</h3>
                                    <p class="text-sm text-slate-500">มีคำถามเรื่องเซตใช่ไหม? ถามได้เลย!</p>
                                </div>
                                <div id="study-chat-box" class="flex-1 p-4 overflow-y-auto custom-scrollbar space-y-4" style="min-height: 250px;">
                                     <div class="flex justify-start">
                                        <div class="bg-white/60 backdrop-blur-lg border border-white/20 p-3 rounded-lg max-w-xs">
                                             <p class="text-sm">
                                                สวัสดีค่ะน้อง! มาคุยเรื่องเซตว่างกันนะคะ เข้าใจว่าดูคลิปมาแล้ว เดี๋ยวพี่น้องขอมสรุปให้ง่าย ๆ เลยค่ะ 😊<br><br>
                                                <strong>เซตว่าง (Empty Set)</strong> ก็คือ:<br>
                                                • <strong>เซตที่ไม่มีสมาชิกอยู่เลยแม้แต่ตัวเดียว</strong> ค่ะ<br>
                                                • เหมือนกล่องเปล่า ๆ ที่ข้างในไม่มีอะไรอยู่เลยนั่นแหละค่ะ<br><br>
                                                <strong>ตัวอย่างง่าย ๆ เช่น:</strong><br>
                                                • เซตของจำนวนนับที่น้อยกว่า 1 (ไม่มีใช่ไหมคะ?)<br>
                                                • เซตของคนที่อายุเกิน 200 ปี (ตอนนี้ก็ยังไม่มีเนอะ)<br><br>
                                                <strong>สัญลักษณ์ของเซตว่าง:</strong><br>
                                                • เราจะใช้สัญลักษณ์ &empty; (วงกลมมีขีดทับ) หรือ {} ค่ะ<br><br>
                                                จำง่าย ๆ ว่าเป็นเซตที่ "ว่างเปล่า" นั่นเองค่ะ
                                            </p>
                                        </div>
                                    </div>
                                </div>
                                <div class="p-4 border-t border-white/30">
                                    <div class="flex space-x-2">
                                        <input type="text" id="study-chat-input" class="flex-1 border-slate-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 transition-all duration-300 bg-white/60 backdrop-blur-lg border-white/20" placeholder="พิมพ์คำถามของคุณ...">
                                        <button id="study-chat-send" class="aurora-button px-4 py-2 rounded-lg font-semibold text-sm">ส่ง</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section id="recap-arcade" class="app-section hidden">
                 <div id="arcade-menu">
                    <h2 class="text-3xl font-bold text-slate-800 mb-6">อาเขตทบทวน</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                        <div class="group bg-white/70 backdrop-blur-xl p-6 rounded-xl shadow-lg border border-white/30 text-center cursor-pointer hover:shadow-2xl hover:shadow-blue-500/20 hover:-translate-y-2 transition-all duration-300" id="start-flashcard-mode">
                            <div class="flex justify-center mb-4">
                               <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-blue-500 group-hover:scale-110 transition-transform duration-300" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                  <path stroke-linecap="round" stroke-linejoin="round" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" />
                               </svg>
                            </div>
                            <h3 class="text-xl font-bold text-slate-800 mb-2">โหมดแฟลชการ์ด</h3>
                            <p class="text-slate-600 text-sm">ทบทวนคำศัพท์และนิยาม</p>
                        </div>
                        <div class="group bg-white/70 backdrop-blur-xl p-6 rounded-xl shadow-lg border border-white/30 text-center cursor-pointer hover:shadow-2xl hover:shadow-purple-500/20 hover:-translate-y-2 transition-all duration-300" id="start-speed-mode">
                             <div class="flex justify-center mb-4">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-purple-500 group-hover:scale-110 transition-transform duration-300" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                  <path stroke-linecap="round" stroke-linejoin="round" d="M13 10V3L4 14h7v7l9-11h-7z" />
                                </svg>
                             </div>
                             <h3 class="text-xl font-bold text-slate-800 mb-2">ทดสอบความเร็ว</h3>
                            <p class="text-slate-600 text-sm">เกมยิงคำตอบ</p>
                        </div>
                        <div class="group bg-white/70 backdrop-blur-xl p-6 rounded-xl shadow-lg border border-white/30 text-center cursor-pointer hover:shadow-2xl hover:shadow-green-500/20 hover:-translate-y-2 transition-all duration-300" id="start-set-ops-game">
                             <div class="flex justify-center mb-4">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-green-500 group-hover:scale-110 transition-transform duration-300" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M4.874 15.69A7.5 7.5 0 1015.69 4.874M4.874 15.69L2 17.564M15.69 4.874L17.564 2" />
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 7.5a4.5 4.5 0 11-4.5 4.5" />
                                </svg>
                             </div>
                             <h3 class="text-xl font-bold text-slate-800 mb-2">การดำเนินการของเซ็ต</h3>
                            <p class="text-slate-600 text-sm">ตอบคำถามยูเนียน อินเตอร์เซกชัน</p>
                        </div>
                         <div class="group bg-white/70 backdrop-blur-xl p-6 rounded-xl shadow-lg border border-white/30 text-center cursor-pointer hover:shadow-2xl hover:shadow-red-500/20 hover:-translate-y-2 transition-all duration-300" id="start-venn-diagram-game">
                             <div class="flex justify-center mb-4">
                                 <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-red-500 group-hover:scale-110 transition-transform duration-300" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                     <circle cx="10" cy="12" r="6" />
                                     <circle cx="14" cy="12" r="6" />
                                 </svg>
                             </div>
                             <h3 class="text-xl font-bold text-slate-800 mb-2">แผนภาพเวนน์-ออยเลอร์</h3>
                            <p class="text-slate-600 text-sm">ทายความหมายจากพื้นที่แรเงา</p>
                        </div>
                    </div>
                     <div class="mt-8 bg-white/70 backdrop-blur-xl p-6 rounded-xl shadow-lg border border-white/30">
                        <h3 class="text-xl font-bold text-slate-800 mb-4">สถิติและความคืบหน้า</h3>
                        <div class="flex items-center space-x-4">
                            <div class="bg-purple-100/80 p-3 rounded-full">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-purple-600" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                  <path stroke-linecap="round" stroke-linejoin="round" d="M9 11l3-3m0 0l3 3m-3-3v8m0-13a9 9 0 110 18 9 9 0 010-18z" />
                                </svg>
                            </div>
                            <div>
                                <p class="text-slate-600">คะแนนสูงสุด (โหมดทดสอบความเร็ว)</p>
                                <p id="arcade-high-score" class="text-2xl font-bold text-slate-800">0</p>
                            </div>
                        </div>
                    </div>
                 </div>

                 <!-- Flashcard Mode Content -->
                 <div id="flashcard-mode-content" class="app-sub-section hidden flex-col items-center">
                    <button class="back-to-arcade-menu mb-6 text-indigo-600 hover:text-indigo-800">&larr; กลับไปเลือกโหมด</button>
                    <div id="flashcard-container" class="relative w-full max-w-lg h-72 perspective-1000">
                        <div id="flashcard-inner" class="relative w-full h-full text-center flip-card-inner">
                            <div class="absolute w-full h-full p-6 bg-white/70 backdrop-blur-xl rounded-xl shadow-lg border border-white/30 flex items-center justify-center flip-card-front">
                                <p id="flashcard-front-text" class="text-2xl font-semibold"></p>
                            </div>
                            <div class="absolute w-full h-full p-6 bg-indigo-500 text-white rounded-xl shadow-lg flex items-center justify-center flip-card-back">
                                <p id="flashcard-back-text" class="text-xl"></p>
                            </div>
                        </div>
                    </div>
                    <p id="flashcard-counter" class="text-slate-500 mt-4"></p>
                    <div class="mt-6 flex space-x-4">
                        <button id="prev-flashcard" class="px-6 py-2 bg-white/70 backdrop-blur-xl border border-white/30 rounded-lg hover:bg-white/80 transition-colors duration-300">ก่อนหน้า</button>
                        <button id="flip-flashcard" class="px-8 py-2 bg-indigo-600 text-white font-semibold rounded-lg hover:bg-indigo-700 transition-colors duration-300">พลิกการ์ด</button>
                        <button id="next-flashcard" class="px-6 py-2 bg-white/70 backdrop-blur-xl border border-white/30 rounded-lg hover:bg-white/80 transition-colors duration-300">ถัดไป</button>
                    </div>
                </div>

                <!-- Speed Quiz Mode Content -->
                <div id="speed-quiz-mode-content" class="app-sub-section hidden">
                     <div id="speed-quiz-game-area" class="relative w-full max-w-3xl mx-auto h-[80vh] rounded-2xl shadow-2xl overflow-hidden bg-[#0B0F29]">
                        <div class="absolute top-0 left-0 w-full h-16 bg-[#1D244F] z-30 flex items-center justify-between px-4">
                            <div class="flex items-center space-x-2">
                                <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>
                                <span id="speed-quiz-score-top" class="text-white font-bold text-lg">0</span>
                            </div>
                             <div class="flex items-center space-x-2">
                                <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                                <span id="speed-quiz-timer-top" class="text-white font-bold text-lg">30</span>
                            </div>
                            <button class="back-to-arcade-menu text-white">
                                 <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                            </button>
                        </div>

                        <canvas id="background-canvas" class="absolute top-0 left-0 w-full h-full z-0"></canvas>
                        <canvas id="laser-canvas" class="absolute top-0 left-0 w-full h-full pointer-events-none z-20"></canvas>
                        <canvas id="confetti-canvas" class="absolute top-0 left-0 w-full h-full pointer-events-none z-50"></canvas>
                        
                         <div id="speed-quiz-start-overlay" class="absolute inset-0 bg-black/50 flex flex-col items-center justify-center z-40">
                            <h3 class="text-4xl font-bold text-white mb-2">โหมดทดสอบความเร็ว</h3>
                             <p class="text-white/80 mb-6">ยิงคำตอบที่ถูกต้องก่อนเวลาจะหมด!</p>
                            <button id="speed-quiz-start-btn" class="aurora-button px-10 py-4 font-bold rounded-lg text-lg">เริ่มเกม</button>
                        </div>
                        <div id="countdown-overlay" class="hidden absolute inset-0 bg-[#0B0F29]/80 flex-col items-center justify-center z-40 text-white text-9xl font-bold">
                            <span id="countdown-text" class="countdown-number">3</span>
                        </div>
                        <div id="speed-quiz-end-overlay" class="hidden absolute inset-0 bg-[#0B0F29]/90 backdrop-blur-md flex-col items-center justify-center z-40 p-8">
                           <div class="w-full max-w-md text-center">
                               <img src="https://img.icons8.com/plasticine/100/000000/trophy.png" alt="Trophy" class="mx-auto mb-4 h-24 w-24"/>
                               <h3 class="text-3xl font-bold text-white mb-2">ทำได้ดีมาก!</h3>
                               <p class="text-white/80 text-lg mb-6">นี่คือคะแนนสุดท้ายของคุณ</p>
                               <div class="flex space-x-4 w-full">
                                   <div class="w-1/2 bg-blue-500/20 backdrop-blur-lg border border-white/20 p-4 rounded-lg text-center">
                                       <p class="text-blue-200 text-sm">คะแนนของคุณ</p>
                                       <p id="final-score" class="text-white text-4xl font-bold">0</p>
                                   </div>
                                   <div class="w-1/2 bg-fuchsia-500/20 backdrop-blur-lg border border-white/20 p-4 rounded-lg text-center">
                                       <p class="text-fuchsia-200 text-sm">คะแนนสูงสุด</p>
                                       <p id="high-score" class="text-white text-4xl font-bold">0</p>
                                   </div>
                               </div>
                               <button id="speed-quiz-restart-btn" class="aurora-button mt-8 w-full py-3 font-bold rounded-lg text-lg">เล่นอีกครั้ง</button>
                                <button class="back-to-arcade-menu mt-4 w-full py-3 font-semibold rounded-lg text-white/70 hover:text-white transition-colors">กลับไปเลือกโหมด</button>
                           </div>
                        </div>
                        
                        <!-- Game elements -->
                        <div id="speed-quiz-question-area" class="absolute top-20 left-1/2 -translate-x-1/2 w-[90%] max-w-2xl bg-black/40 backdrop-blur-sm p-4 rounded-lg text-white text-center z-30 opacity-100 transition-opacity duration-300">
                             <p id="speed-quiz-question-text" class="text-xl font-semibold"></p>
                        </div>

                        <div id="shooter-container" class="absolute bottom-4 left-1/2 -translate-x-1/2 w-24 h-24 z-30">
                             <svg viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M50 0C48.4488 4.29171 44.2917 8.44876 40 10C35.7083 11.5512 30.5833 11.5512 25 10C19.4167 8.44876 15.2596 4.29171 10 0L0 15C4.29171 19.7404 8.44876 24.2211 10 30C11.5512 35.7789 11.5512 41.6667 10 45C8.44876 50.5556 4.29171 55.2596 0 60L10 90C19.4167 85.5833 29.2596 80.7596 40 80H60C70.7404 80.7596 80.5833 85.5833 90 90L100 60C95.7083 55.2596 91.5512 50.5556 90 45C88.4488 39.4444 88.4488 33.5556 90 30C91.5512 24.4444 95.7083 19.7404 100 15L90 0C80.5833 4.41667 70.7404 8.44876 60 10C55.7083 11.5512 51.5512 11.5512 50 10V0Z" fill="url(#paint0_linear_1_2)"/>
                                <circle cx="50" cy="45" r="12" fill="#24294A" stroke="white" stroke-width="2"/>
                                <circle cx="50" cy="45" r="5" fill="#7DF0E5"/>
                                <defs>
                                <linearGradient id="paint0_linear_1_2" x1="50" y1="0" x2="50" y2="90" gradientUnits="userSpaceOnUse">
                                <stop stop-color="#3D457F"/>
                                <stop offset="1" stop-color="#24294A"/>
                                </linearGradient>
                                </defs>
                            </svg>
                        </div>
                    </div>
                </div>

                 <!-- Set Operations Game -->
                <div id="set-operations-game" class="app-sub-section hidden">
                    <button class="back-to-arcade-menu mb-6 text-indigo-600 hover:text-indigo-800">&larr; กลับไปเลือกโหมด</button>
                    <div class="max-w-3xl mx-auto bg-white/70 backdrop-blur-xl p-6 md:p-8 rounded-2xl shadow-lg border border-white/30">
                        <h3 class="text-2xl font-bold text-center text-slate-800 mb-6">เกมทายการดำเนินการของเซ็ต</h3>
                        <div id="set-ops-question-container" class="text-center mb-6">
                            <!-- Question will be injected here -->
                        </div>
                        <div id="set-ops-options-container" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <!-- Options will be injected here -->
                        </div>
                         <div id="set-ops-feedback" class="mt-6 text-center font-bold"></div>
                    </div>
                </div>

                <!-- Venn Diagram Menu -->
                 <div id="venn-diagram-menu" class="app-sub-section hidden">
                    <button class="back-to-arcade-menu mb-6 text-indigo-600 hover:text-indigo-800">&larr; กลับไปเลือกโหมด</button>
                     <h2 class="text-3xl font-bold text-slate-800 mb-6 text-center">เลือกประเภทแผนภาพเวนน์</h2>
                     <div class="max-w-3xl mx-auto grid grid-cols-1 md:grid-cols-2 gap-8">
                         <div class="group bg-white/70 backdrop-blur-xl p-8 rounded-xl shadow-lg border border-white/30 text-center cursor-pointer hover:shadow-2xl hover:shadow-cyan-500/20 hover:-translate-y-2 transition-all duration-300" id="start-venn-2">
                             <div class="flex justify-center mb-4">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16 text-cyan-500 group-hover:scale-110 transition-transform duration-300" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
                                     <circle cx="9" cy="12" r="5" />
                                     <circle cx="15" cy="12" r="5" />
                                 </svg>
                             </div>
                             <h3 class="text-2xl font-bold text-slate-800 mb-2">2 วง</h3>
                             <p class="text-slate-600">แผนภาพสำหรับ 2 เซ็ต (A, B)</p>
                         </div>
                         <div class="group bg-white/70 backdrop-blur-xl p-8 rounded-xl shadow-lg border border-white/30 text-center cursor-pointer hover:shadow-2xl hover:shadow-amber-500/20 hover:-translate-y-2 transition-all duration-300" id="start-venn-3">
                              <div class="flex justify-center mb-4">
                                 <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16 text-amber-500 group-hover:scale-110 transition-transform duration-300" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
                                     <circle cx="12" cy="9.5" r="4.5" />
                                     <circle cx="9" cy="14.5" r="4.5" />
                                     <circle cx="15" cy="14.5" r="4.5" />
                                 </svg>
                              </div>
                              <h3 class="text-2xl font-bold text-slate-800 mb-2">3 วง</h3>
                             <p class="text-slate-600">แผนภาพสำหรับ 3 เซ็ต (A, B, C)</p>
                         </div>
                     </div>
                 </div>
                
                 <!-- Venn Diagram Game -->
                <div id="venn-diagram-game" class="app-sub-section hidden">
                    <button class="back-to-venn-menu mb-6 text-indigo-600 hover:text-indigo-800">&larr; กลับไปเลือกประเภท</button>
                    <div class="max-w-4xl mx-auto bg-white/70 backdrop-blur-xl p-4 md:p-8 rounded-2xl shadow-lg border border-white/30">
                        <h3 id="venn-game-title" class="text-2xl font-bold text-center text-slate-800 mb-4">พื้นที่แรเงาแทนเซ็ตใด?</h3>
                        <div id="venn-diagram-container" class="my-6 flex justify-center items-center">
                           <!-- Venn Diagram SVG will be injected here -->
                        </div>
                        <div id="venn-options-container" class="grid grid-cols-2 md:grid-cols-4 gap-3 md:gap-4">
                           <!-- Options will be injected here -->
                        </div>
                        <div id="venn-feedback" class="mt-6 text-center font-bold"></div>
                    </div>
                </div>

            </section>

            <section id="collab-hub" class="app-section hidden">
                <h2 class="text-3xl font-bold text-slate-800 mb-6">ศูนย์รวมความร่วมมือ</h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    <!-- Student Chat -->
                    <div class="md:col-span-2 bg-white/70 backdrop-blur-xl rounded-xl shadow-lg border border-white/30 p-6">
                        <h3 class="text-xl font-semibold mb-4">พูดคุยกับเพื่อนๆ</h3>
                        <div class="h-96 border border-white/30 rounded-lg mb-4 p-4 overflow-y-auto custom-scrollbar">
                           <p class="text-slate-500 text-center">ฟีเจอร์แชทกลุ่มกำลังจะมาเร็วๆ นี้!</p>
                        </div>
                        <div class="flex space-x-2">
                           <input type="text" class="flex-1 border-slate-300 bg-white/70 rounded-lg" placeholder="พิมพ์ข้อความ..." disabled>
                           <button class="bg-slate-300 text-white px-4 py-2 rounded-lg cursor-not-allowed">ส่ง</button>
                        </div>
                    </div>
                    <!-- Find Friends & AI Help -->
                    <div class="space-y-8">
                        <div class="bg-white/70 backdrop-blur-xl rounded-xl shadow-lg border border-white/30 p-6">
                            <h3 class="text-xl font-semibold mb-4">AI ช่วยแก้โจทย์</h3>
                            <p class="text-slate-600 mb-4">ติดปัญหาโจทย์ยากใช่ไหม? ให้ AI ของเราช่วยหาคำตอบและอธิบายแนวคิดให้คุณ</p>
                            <button id="open-ai-solver-btn" class="aurora-button w-full font-semibold py-3 rounded-lg transition-all duration-300">เริ่มใช้งาน AI Solver</button>
                        </div>
                        <div class="bg-white/70 backdrop-blur-xl rounded-xl shadow-lg border border-white/30 p-6">
                            <h3 class="text-xl font-semibold mb-4">หาเพื่อนเรียนด้วยกัน</h3>
                            <ul class="space-y-3">
                                <li class="flex items-center justify-between">
                                    <span class="

